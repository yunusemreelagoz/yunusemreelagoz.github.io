(this["webpackJsonpflapp-bird"]=this["webpackJsonpflapp-bird"]||[]).push([[0],{14:function(t,i,e){},15:function(t,i,e){},16:function(t,i,e){"use strict";e.r(i);var n=e(1),s=e.n(n),a=e(4),r=e.n(a),o=(e(14),e(6)),h=e(7),u=e(5),c=e(8),l=e(0),d=e(2),f=(e(15),function(){function t(i,e){var n=this;Object(l.a)(this,t),this.rows=i,this.cols=e,this.data=Array(this.rows).fill().map((function(){return Array(n.cols).fill(0)}))}return Object(d.a)(t,[{key:"copy",value:function(){for(var i=new t(this.rows,this.cols),e=0;e<this.rows;e++)for(var n=0;n<this.cols;n++)i.data[e][n]=this.data[e][n];return i}},{key:"toArray",value:function(){for(var t=[],i=0;i<this.rows;i++)for(var e=0;e<this.cols;e++)t.push(this.data[i][e]);return t}},{key:"randomize",value:function(){return this.map((function(t){return 2*Math.random()-1}))}},{key:"add",value:function(i){return i instanceof t?this.rows!==i.rows||this.cols!==i.cols?void console.log("Columns and Rows of A must match Columns and Rows of B."):this.map((function(t,e,n){return t+i.data[e][n]})):this.map((function(t){return t+i}))}},{key:"multiply",value:function(i){return i instanceof t?this.rows!==i.rows||this.cols!==i.cols?void console.log("Columns and Rows of A must match Columns and Rows of B."):this.map((function(t,e,n){return t*i.data[e][n]})):this.map((function(t){return t*i}))}},{key:"map",value:function(t){for(var i=0;i<this.rows;i++)for(var e=0;e<this.cols;e++){var n=this.data[i][e];this.data[i][e]=t(n,i,e)}return this}},{key:"print",value:function(){return console.table(this.data),this}},{key:"serialize",value:function(){return JSON.stringify(this)}}],[{key:"fromArray",value:function(i){return new t(i.length,1).map((function(t,e){return i[e]}))}},{key:"subtract",value:function(i,e){if(i.rows===e.rows&&i.cols===e.cols)return new t(i.rows,i.cols).map((function(t,n,s){return i.data[n][s]-e.data[n][s]}));console.log("Columns and Rows of A must match Columns and Rows of B.")}},{key:"transpose",value:function(i){return new t(i.cols,i.rows).map((function(t,e,n){return i.data[n][e]}))}},{key:"multiply",value:function(i,e){if(i.cols===e.rows)return new t(i.rows,e.cols).map((function(t,n,s){for(var a=0,r=0;r<i.cols;r++)a+=i.data[n][r]*e.data[r][s];return a}));console.log("Columns of A must match rows of B.")}},{key:"map",value:function(i,e){return new t(i.rows,i.cols).map((function(t,n,s){return e(i.data[n][s],n,s)}))}},{key:"deserialize",value:function(i){"string"==typeof i&&(i=JSON.parse(i));var e=new t(i.rows,i.cols);return e.data=i.data,e}}]),t}()),p=function t(i,e){Object(l.a)(this,t),this.func=i,this.dfunc=e},m=new p((function(t){return 1/(1+Math.exp(-t))}),(function(t){return t*(1-t)})),v=(new p((function(t){return Math.tanh(t)}),(function(t){return 1-t*t})),function(){function t(i,e,n){if(Object(l.a)(this,t),i instanceof t){var s=i;this.input_nodes=s.input_nodes,this.hidden_nodes=s.hidden_nodes,this.output_nodes=s.output_nodes,this.weights_ih=s.weights_ih.copy(),this.weights_ho=s.weights_ho.copy(),this.bias_h=s.bias_h.copy(),this.bias_o=s.bias_o.copy()}else this.input_nodes=i,this.hidden_nodes=e,this.output_nodes=n,this.weights_ih=new f(this.hidden_nodes,this.input_nodes),this.weights_ho=new f(this.output_nodes,this.hidden_nodes),this.weights_ih.randomize(),this.weights_ho.randomize(),this.bias_h=new f(this.hidden_nodes,1),this.bias_o=new f(this.output_nodes,1),this.bias_h.randomize(),this.bias_o.randomize();this.setLearningRate(),this.setActivationFunction()}return Object(d.a)(t,[{key:"predict",value:function(t){var i=f.fromArray(t),e=f.multiply(this.weights_ih,i);e.add(this.bias_h),e.map(this.activation_function.func);var n=f.multiply(this.weights_ho,e);return n.add(this.bias_o),n.map(this.activation_function.func),n.toArray()}},{key:"setLearningRate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;this.learning_rate=t}},{key:"setActivationFunction",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m;this.activation_function=t}},{key:"train",value:function(t,i){var e=f.fromArray(t),n=f.multiply(this.weights_ih,e);n.add(this.bias_h),n.map(this.activation_function.func);var s=f.multiply(this.weights_ho,n);s.add(this.bias_o),s.map(this.activation_function.func);var a=f.fromArray(i),r=f.subtract(a,s),o=f.map(s,this.activation_function.dfunc);o.multiply(r),o.multiply(this.learning_rate);var h=f.transpose(n),u=f.multiply(o,h);this.weights_ho.add(u),this.bias_o.add(o);var c=f.transpose(this.weights_ho),l=f.multiply(c,r),d=f.map(n,this.activation_function.dfunc);d.multiply(l),d.multiply(this.learning_rate);var p=f.transpose(e),m=f.multiply(d,p);this.weights_ih.add(m),this.bias_h.add(d)}},{key:"serialize",value:function(){return JSON.stringify(this)}},{key:"copy",value:function(){return new t(this)}},{key:"mutate",value:function(t){this.weights_ih.map(t),this.weights_ho.map(t),this.bias_h.map(t),this.bias_o.map(t)}}],[{key:"deserialize",value:function(i){"string"==typeof i&&(i=JSON.parse(i));var e=new t(i.input_nodes,i.hidden_nodes,i.output_nodes);return e.weights_ih=f.deserialize(i.weights_ih),e.weights_ho=f.deserialize(i.weights_ho),e.bias_h=f.deserialize(i.bias_h),e.bias_o=f.deserialize(i.bias_o),e.learning_rate=i.learning_rate,e}}]),t}()),y=500,g=800,w=70,_=30,b=240,x=0,k=function(){function t(i,e){var n=this;Object(l.a)(this,t),this.mutate=function(){n.brain.mutate((function(t){return Math.random()<.1?(n.mutated=!0,t+Math.random()):t}))},this.ctx=i,this.x=150,this.y=250,this.gravity=1,this.velocity=.2,this.frameCount=0,this.mutated=!1,e instanceof v?(this.brain=e.copy(),this.mutate()):this.brain=new v(5,5,2)}return Object(d.a)(t,[{key:"draw",value:function(){this.ctx.fillStyle=this.mutated?"green":"black",this.ctx.beginPath(),this.ctx.arc(this.x,this.y,10,0,2*Math.PI),this.ctx.fill()}},{key:"update",value:function(t,i,e){this.frameCount+=1,this.gravity+=this.velocity,this.gravity>1&&(this.gravity=1),this.y+=this.gravity,this.y<=0&&(this.y=0,this.isDead=!0),this.y>=y&&(this.y=y,this.isDead=!0),this.think(t,i,e)}},{key:"jump",value:function(t){this.gravity=t}},{key:"think",value:function(t,i,e){var n=[((t-this.x)/(g-this.x)).toFixed(2),(i/y).toFixed(2),(e/y).toFixed(2),(this.y/y).toFixed(2),(this.gravity/3).toFixed(2)],s=this.brain.predict(n);s[0]<s[1]&&this.jump(-3)}}]),t}(),C=function(){function t(i,e,n){Object(l.a)(this,t),this.ctx=i,this.x=g,this.y=e?y-e:0,this.width=_,this.height=e||w+Math.random()*Math.round(y-(n+2*w))}return Object(d.a)(t,[{key:"draw",value:function(){this.ctx.fillStyle="#000",this.ctx.fillRect(this.x,this.y,this.width,this.height)}},{key:"update",value:function(){this.x-=1,this.x+_<0&&(this.isDead=!0)}}]),t}(),O=function(t){function i(t){var e;return Object(l.a)(this,i),(e=Object(h.a)(this,Object(u.a)(i).call(this,t))).getCtx=function(){return e.canvasRef.current.getContext("2d")},e.generatePipes=function(){var t=e.getCtx(),i=new C(t,null,e.space),n=y-(i.height+e.space);return[i,new C(t,n,e.space)]},e.gameLoop=function(){e.update(),e.draw()},e.update=function(){if(e.frameCount=e.frameCount+1,e.frameCount%400===0){var t,i=e.generatePipes();(t=e.pipes).push.apply(t,Object(o.a)(i))}0===e.birds.length&&e.frameCount%100===0&&e.generateNewGeneration(e.getCtx()),e.pipes.forEach((function(t){return t.x--})),e.pipes=e.pipes.filter((function(t){return!t.isDead})),e.birds.length===e.birds.filter((function(t){return t.isDead})).length&&e.birds[0]&&e.birds[0].frameCount>x&&(x=e.birds[0].frameCount,e.smartestBird=e.birds[0]),e.birds=e.birds.filter((function(t){return!t.isDead})),e.birds.length>0&&e.birds[0].frameCount>x&&(x=e.birds[0].frameCount,e.smartestBird=e.birds[0]),e.birds.forEach((function(t){var i=e.getNextPipe(t),n=i.y+i.height;t.update(i.x,n,n+e.space)})),e.isGameOver()&&(clearInterval(e.loop),alert("GAME OVER"))},e.getNextPipe=function(t){for(var i=0;i<e.pipes.length;i++)if(e.pipes[i].x>t.x)return e.pipes[i]},e.isGameOver=function(){var t=!1;return e.birds.forEach((function(i){e.pipes.forEach((function(e){(i.x>e.x&&i.x<e.x+e.width&&i.y>e.y&&i.y<e.y+e.height||i.y>y||i.y<0)&&(i.isDead=!0),t=!1}))})),t},e.draw=function(){var t=e.canvasRef.current.getContext("2d");t.clearRect(0,0,g,y),e.pipes.forEach((function(t){return t.draw()})),e.birds.forEach((function(t){return t.draw()})),t.fillStyle="#000",t.fillText("Nesil: ".concat(e.generationCount),15,15),t.fillText("Ku\u015f: ".concat(e.birds.length),15,30),t.fillText("Score: ".concat((x/b).toFixed(1)," sn"),15,45)},e.canvasRef=s.a.createRef(),e.space=100,e.frameCount=0,e.generationCount=0,e.pipes=[],e.birds=[],e}return Object(c.a)(i,t),Object(d.a)(i,[{key:"componentDidMount",value:function(){var t=this.getCtx();this.pipes=this.generatePipes(),this.birds=this.generateBirds(t),this.loop=setInterval(this.gameLoop,1e3/b)}},{key:"generateBirds",value:function(t){for(var i=[],e=0;e<250;e++){var n=new k(t,this.smartestBird?this.smartestBird.brain:void 0);i.push(n)}return i}},{key:"generateNewGeneration",value:function(t){this.generationCount+=1,this.birds=this.generateBirds(t)}},{key:"render",value:function(){return s.a.createElement("div",{className:"App"},s.a.createElement("canvas",{ref:this.canvasRef,height:y,width:g,style:{marginTop:"24px",border:"1px solid #c3c3c3"}}))}}]),i}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(s.a.createElement(O,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))},9:function(t,i,e){t.exports=e(16)}},[[9,1,2]]]);
//# sourceMappingURL=main.b29af18c.chunk.js.map